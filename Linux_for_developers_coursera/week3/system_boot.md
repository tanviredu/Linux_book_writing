SYSTEM BOOT

Vitually all x86 based physical Linux system (outsite the enbedded sphere) today used GRUB(GRAND Uniform Bootloader) to handle early phases of system startup

all x86 used the GRUB


early phases of he system startup is handled by the GRUB
but this is not true for the embadded system

Other platform may have other equivalent such as ELILO used in IA64 (itanium)
embadded system used U-Boot on many enbadded configuration

Important fetures of the GRUB bootloader

	1) Alternative OS can be choosed .THhis is called bootloader
	2) Within a  OS Alternative Kernel and initial ramdisk can be choosed
	3) Boot parameter can be easily changed by editing the configuration



GRUB has  a number version mordan distribution used GRUB 2 which is ndifferent than GRUB 1 and the mordan distribution uses the GRUB2 but the philosophy is the same
the basic grub configuration file stored in the /boot/grub2 folder and the name
is grub.cfg

[root@localhost tmp]# cd /boot/grub2/
[root@localhost grub2]# ls
device.map  fonts  grub.cfg  grubenv  i386-pc  locale



this is not a file that you edit it is generated by the  when you instlling the kernel or compiling the kernel

there are another directory where grub configuration located 

	'/etc/grub.d'

[root@localhost grub2]# cd /etc/grub.d/
[root@localhost grub.d]# ls
00_header  00_tuned  01_users  10_linux  20_linux_xen  20_ppc_terminfo  30_os-prober  40_custom  41_custom  README


in the directory there are configuration file thats define how grub works

there are also another file 
int 

/etc/default called grub and it holds all the parameter 

this file should not edited by hands


when the system boots

Booting starts with BIOS (BASIC INPUT OUTPUT SYSTEM) that identify and  inittilize all the system periferal devicces

IF the BIOS permit then it can boot the peripheral system like CD/DVD floppy and USB Drive or through the network pxe more like it boot of the configured hard drive.you cn make choice of booting the bios from different media


Then it goes to the MBR that had the partition table and bootloader that is a small program which is responsible for loading the operating system this has to have a least sufficient smarts to locate the kernel from disk


the kernel have many name but most of them like vmlinuz-<version number>

	the z in the vmlinuz says that the kernel is compressed
	but it automatically self decompress upon loading

	in most circumstances it placed unde the /boot directory but it can have its own partition






a /boot directory might contain this elements

[root@localhost boot]# ls -lF
total 23456
-rw-r--r--. 1 root root   151923 May 14  2019 config-3.10.0-957.12.2.el7.x86_64
drwxr-xr-x. 3 root root       17 Jun  1  2019 efi/
drwx------. 5 root root       97 Jun  1  2019 grub2/
-rw-------. 1 root root 13350422 Jun  1  2019 initramfs-3.10.0-957.12.2.el7.x86_64.img
-rw-r--r--. 1 root root   314126 May 14  2019 symvers-3.10.0-957.12.2.el7.x86_64.gz
-rw-------. 1 root root  3545659 May 14  2019 System.map-3.10.0-957.12.2.el7.x86_64
-rwxr-xr-x. 1 root root  6643904 May 14  2019 vmlinuz-3.10.0-957.12.2.el7.x86_64*


1) in this example the vmlinuz is the compressed kernel

2)initramfs : contains the initial root filesystem which is located as a ramdisk (that means the / partition lis loaded as  the ramdisk) as well as essential kernel modules (the drivers that needed for the hardware) that program need to load and some modules that needed to load the file system


3)config: the config file contains all the configuuration about how it was compiled but it is not needed for for the OS to operate

System.map: it lists the complete kernel symbol table.it is used for debuffing purpose

when the bootloader screen comes select the /boot and press 'e' this will let you to edit the boot configuration file and then
go to the kernel command line at the end of the kernel you can add tthe runlavel for textbased runlavel add 3 at the end of the line and if you rmove the word quite from the configuration file this system boot up will be verbose
and you dont see the logo

then press (ctrl+x)

now it will give you the login shell now after login type:

=> sudo systemctl start gdm

this will show the graphical login screen

now you can type the username and login credential in the graphical interface to go on




						system initalization


after the boot process to make the operating system to fully oprating state the system runs a command called 

init located at

=> /sbin/init

it define the user lavel process or task that runs on the system and continuous to run untill the system shutdown

-> although user can controll it and it is considered as  a user process but still some processs run directly from the kernel

inti coordinates the later part of the booting process 
after init stated it handles all the boot process it set the login process and set all the environment and start all the process tht is needed and terminate if it is not used

basically all the distribution based on the UNIX process uses SYSVinit in unix

the main concern of the init that runone process after another to make things right
in the SysVinit booting type does not given prefrence cause they were designed for the mainframe computer



new method insted of SysVinit

1) upstart
2) systemd


1) upstart is developed by the ubuntu and included in the 6.0 release make it default in 9.10
adopted by the fedora centos and Oracle Linux and openSUse
and also used in various embedded devices

2) systemd comes in 2011 in fedora

now a days all the major system uses it and even ubuntu change the upstart to the systemd
upstart is obsolite and the SysVinit no longer exisst

for system controll we use systemctl

system runlavel

	runlevel			meaning
-----------			---------------

	0					shutdown/halt
	1					single user mode
	2					multi user mode with text and no NFS
	3					multiuser with NFS and network
	4					not used
	5					multiuser network NFS GUI (default)
	6					Reboot


to find a  runlevel in a centos system the command 

=> runlevel


when the init command is used it looks the 

'/etc/inittab' file [we no longer use the inittab]
and it tells you which scrupt to run and the file that is told by the inittab bring the system each runlevel and it is done with series of lines


inittab syntax is like

id:<runlevel>:<action>:<process>

1)id : a unique 1-4 character for the entry
2) runlevel number
3) action : describe which action is taken
4) proces : says which process should be executed



but now there is only one command thats in the inittab file

=>id:5:initdefault

that the multiuser with network and the GUI

you can change the runlevel with

=> telinit <number>

commnad



to go to the text mode there are two different way

=>sudo telinit 3

or just stop the GUI

=>sudo systemctl stop gdm

and to go to the process agin we start the GUI

=>sudo systemctl start gdm

or
=>telinit 5